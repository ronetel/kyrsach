(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5076],{431:(e,t,a)=>{"use strict";a.d(t,{CartButton:()=>U});var s=a(95155),r=a(12115),i=a(27809),n=a(92138),l=a(66325),d=a(13352),c=a(54416),o=a(46457);function u(e){let{...t}=e;return(0,s.jsx)(d.bL,{"data-slot":"sheet",...t})}function x(e){let{...t}=e;return(0,s.jsx)(d.l9,{"data-slot":"sheet-trigger",...t})}function m(e){let{...t}=e;return(0,s.jsx)(d.bm,{"data-slot":"sheet-close",...t})}function h(e){let{...t}=e;return(0,s.jsx)(d.ZL,{"data-slot":"sheet-portal",...t})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(d.hJ,{"data-slot":"sheet-overlay",className:(0,o.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function g(e){let{className:t,children:a,side:r="right",...i}=e;return(0,s.jsxs)(h,{children:[(0,s.jsx)(p,{}),(0,s.jsxs)(d.UC,{"data-slot":"sheet-content",className:(0,o.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===r&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/5 border-l sm:max-w-sm","left"===r&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/5 border-r sm:max-w-sm","top"===r&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===r&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...i,children:[a,(0,s.jsxs)(d.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,s.jsx)(c.A,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"sheet-header",className:(0,o.cn)("flex flex-col gap-1.5 p-4",t),...a})}function v(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"sheet-footer",className:(0,o.cn)("mt-auto flex flex-col gap-2 p-4",t),...a})}function b(e){let{className:t,...a}=e;return(0,s.jsx)(d.hE,{"data-slot":"sheet-title",className:(0,o.cn)("text-foreground font-semibold",t),...a})}var j=a(6874),y=a.n(j),N=a(66766),w=a(35169),C=a(60714),k=a(68838),z=a(65219),I=a(62525);let A=e=>{let{imageUrl:t,name:a,price:r,quantity:i,details:n,disabled:l,onClickCountButton:d,onClickRemove:c,className:u}=e;return(0,s.jsxs)("div",{className:(0,o.cn)("flex bg-white text-black p-5 gap-6",{"opacity-50 pointer-events-none":l},u),children:[(0,s.jsx)(k._V,{src:t}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(k.R2,{name:a,details:n}),(0,s.jsx)("hr",{className:"my-3"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(z.Q,{onClick:d,value:i}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(k.gm,{value:r}),(0,s.jsx)(I.A,{onClick:c,className:"text-gray-400 cursor-pointer hover:text-gray-600",size:16})]})]})]})]})};var _=a(51685),P=a(59877);let E=e=>{let{children:t}=e,{totalAmount:a,updateItemQuantity:i,items:n,removeCartItem:l}=(0,_._)(),[d,c]=r.useState(!1),h=(e,t,a)=>{i(e,"plus"===a?t+1:t-1)};return(0,s.jsxs)(u,{children:[(0,s.jsx)(x,{asChild:!0,children:t}),(0,s.jsx)(g,{className:"flex flex-col justify-between pb-0 bg-[#F4F1EE] h-full",children:(0,s.jsxs)("div",{className:(0,o.cn)("flex flex-col h-full",!a&&"justify-center"),children:[!a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f,{children:(0,s.jsx)(b,{hidden:!0,children:"Корзина"})}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center w-72 mx-auto",children:[(0,s.jsx)(N.default,{src:"/assets/images/empty-box.png",alt:"Empty cart",width:120,height:120}),(0,s.jsx)(P.y,{size:"sm",text:"Корзина пустая",className:"text-center text-black font-bold my-2"}),(0,s.jsx)("p",{className:"text-center text-neutral-500 mb-5",children:"Добавьте хотя бы один продукт, чтобы совершить заказ"}),(0,s.jsx)(m,{asChild:!0,children:(0,s.jsxs)(C.$,{variant:"red",className:"w-56 h-12 text-base",size:"lg",children:[(0,s.jsx)(w.A,{className:"w-5 mr-2"}),"Вернуться назад"]})})]})]}),a>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f,{children:(0,s.jsx)(b,{hidden:!0,children:"Корзина"})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto px-6 -mx-6",children:n.map(e=>(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(A,{id:e.id,imageUrl:e.imageUrl,details:e.pizzaSize||"",disabled:e.disabled,name:e.name,price:e.price,quantity:e.quantity,onClickCountButton:t=>h(e.id,e.quantity,t),onClickRemove:()=>l(e.id)})},e.id))}),(0,s.jsx)(v,{className:"sticky bottom-0 bg-white p-6",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex mb-4",children:[(0,s.jsxs)("span",{className:"flex flex-1 text-lg text-neutral-500",children:["Итого",(0,s.jsx)("div",{className:"flex-1 border-b border-dashed border-b-neutral-200 relative -top-1 mx-2"})]}),(0,s.jsxs)("span",{className:"font-bold text-black text-lg",children:[a," ₽"]})]}),(0,s.jsx)(y(),{href:"/checkout",children:(0,s.jsx)(C.$,{onClick:()=>c(!0),loading:d?"true":void 0,type:"submit",className:"w-full h-12 text-base",children:"Оформить заказ"})})]})})]})]})})]})},U=e=>{let{className:t}=e,a=(0,l.x)(e=>e.totalAmount),r=(0,l.x)(e=>e.items),d=(0,l.x)(e=>e.loading);return(0,s.jsx)(E,{children:(0,s.jsxs)(C.$,{variant:"red",size:"lg",loading:d,className:(0,o.cn)("group relative ",{"w-[105px]":d},t),children:[(0,s.jsxs)("b",{children:[a," ₽"]}),(0,s.jsx)("span",{className:"h-full w-[1px] bg-white/30 mx-3"}),(0,s.jsxs)("div",{className:"flex items-center gap-1 transition duration-300 group-hover:opacity-0",children:[(0,s.jsx)(i.A,{size:16,className:"relative",strokeWidth:2}),(0,s.jsx)("b",{children:r.length})]}),(0,s.jsx)(n.A,{size:20,className:"absolute right-5 transition duration-300 -translate-x-2 opacity-0 group-hover:opacity-100 group-hover:translate-x-0"})]})})}},574:(e,t,a)=>{"use strict";a.d(t,{n:()=>s});let s=(0,a(65453).v)()(e=>({activeId:1,setActiveId:t=>e({activeId:t})}))},40994:(e,t,a)=>{"use strict";a.d(t,{ProductsGroupList:()=>h});var s=a(95155),r=a(12115),i=a(75557),n=a(46457),l=a(6874),d=a.n(l),c=a(60714),o=a(84616),u=a(59877);let x=e=>{let{id:t,name:a,price:r,imageUrl:i,className:n}=e;return(0,s.jsx)("div",{className:n,children:(0,s.jsxs)(d(),{href:"/product/".concat(t),children:[(0,s.jsx)("div",{className:"flex justify-center bg-dop-bg p-6 rounded-lg h-[260px]",children:(0,s.jsx)("img",{className:"w-[215px] h-[215px]",src:i,alt:a})}),(0,s.jsx)(u.y,{text:a,size:"sm",className:"mb-1 mt-3 font-bold"}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,s.jsxs)("span",{className:"text-[16px]",children:["от ",(0,s.jsxs)("b",{children:[r," ₽"]})]}),(0,s.jsxs)(c.$,{variant:"secondary",className:"text-base font-bold",children:[(0,s.jsx)(o.A,{size:20,className:"mr-1"}),"Добавить"]})]})]})})};var m=a(574);let h=e=>{let{title:t,items:a,listClassName:l,categoryId:d,className:c}=e,o=(0,m.n)(e=>e.setActiveId),h=r.useRef(null),p=(0,i.A)(h,{threshold:.4});return r.useEffect(()=>{(null==p?void 0:p.isIntersecting)&&o(d)},[d,null==p?void 0:p.isIntersecting,o,t]),(0,s.jsxs)("div",{className:c,id:t,ref:h,children:[(0,s.jsx)(u.y,{text:t,size:"lg",className:"font-extrabold mb-5"}),(0,s.jsx)("div",{className:(0,n.cn)("grid grid-cols-3 gap-[50px]",l),children:a.map(e=>{var t;return(0,s.jsx)(x,{id:e.ID_Product,name:e.name,imageUrl:e.imageUrl,price:(null==(t=e.ProductItems[0])?void 0:t.Price)||0},e.ID_Product)})})]})}},42390:(e,t,a)=>{"use strict";a.d(t,{j:()=>C});var s={};a.r(s),a.d(s,{addCartItem:()=>m,getCart:()=>o,removeCartItem:()=>x,updateItemQuantity:()=>u});var r={};a.r(r),a.d(r,{getMe:()=>h});var i={};a.r(i),a.d(i,{search:()=>g});var n={};a.r(n),a.d(n,{addProduct:()=>w,deleteProduct:()=>N,getCategories:()=>f,getOrders:()=>j,getProducts:()=>b,getSizes:()=>v,updateOrderStatus:()=>y});var l=a(23464),d=a(87358);let c=l.A.create({baseURL:d.env.NEXT_PUBLIC_API_URL}),o=async()=>(await c.get("/api/carts")).data,u=async(e,t)=>(await c.patch("/api/carts/"+e,{quantity:t})).data,x=async e=>(await c.delete("/api/carts/"+e)).data,m=async e=>(await c.post("/api/carts",e)).data,h=async()=>{let{data:e}=await c.get("api/auth/me");return e};var p=function(e){return e.SEARCH_PRODUCTS="api/products/search",e}({});let g=async e=>(await c.get(p.SEARCH_PRODUCTS,{params:{query:e}})).data,f=async()=>(await c.get("/api/categories")).data,v=async()=>(await c.get("/api/sizes")).data,b=async()=>(await c.get("/api/products")).data,j=async()=>(await c.get("/api/orders")).data,y=async(e,t)=>(await c.patch("/api/admin/orders/".concat(e,"/status"),t)).data,N=async e=>{await c.delete("/api/products/".concat(e))},w=async e=>(await c.post("/api/products",e)).data,C={cart:s,auth:r,products:i,admin:n}},46457:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(52596),r=a(39688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},51685:(e,t,a)=>{"use strict";a.d(t,{_:()=>i});var s=a(12115),r=a(66325);let i=()=>{let e=(0,r.x)(e=>e);return s.useEffect(()=>{e.fetchCartItems()},[]),e}},59877:(e,t,a)=>{"use strict";a.d(t,{y:()=>i});var s=a(52596),r=a(12115);let i=e=>{let{text:t,size:a="sm",className:i}=e;return r.createElement({xs:"h5",sm:"h4",md:"h3",lg:"h2",xl:"h1","2xl":"h1"}[a],{className:(0,s.A)({xs:"text-[16px]",sm:"text-[22px]",md:"text-[26px]",lg:"text-[32px]",xl:"text-[40px]","2xl":"text-[48px]"}[a],i)},t)}},60714:(e,t,a)=>{"use strict";a.d(t,{$:()=>c});var s=a(95155),r=a(12115),i=a(99708),n=a(74466),l=a(46457);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-dop-bg text-black shadow-xs hover:bg-dop-bg/90 rounded-2xl",red:"bg-mint-500 shadow-xs hover:bg-mint-500/90 rounded-3xl",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:c=!1,loading:o,children:u,...x}=e,m=c?i.Slot:"button";return(0,s.jsx)(m,{"data-slot":"button",className:(0,l.cn)(d({variant:r,size:n,className:a}),o&&"opacity-75 pointer-events-none"),disabled:!!o,"aria-busy":!!o,ref:t,...x,children:o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),u]}):u})});c.displayName="Button"},65219:(e,t,a)=>{"use strict";a.d(t,{Q:()=>c});var s=a(95155);a(12115);var r=a(84616),i=a(87712),n=a(60714),l=a(46457);let d=e=>{let{size:t="sm",disabled:a,type:d,onClick:c}=e;return(0,s.jsx)(n.$,{variant:"outline",disabled:a,onClick:c,type:"button",className:(0,l.cn)("p-0 hover:bg-primary hover:text-white disabled:bg-white disabled:border-gray-400 disabled:text-gray-400","sm"===t?"w-[30px] h-[30px] rounded-[10px]":"w-[38px] h-[38px] rounded-md"),children:"plus"===d?(0,s.jsx)(r.A,{className:"sm"===t?"h-4":"h-5"}):(0,s.jsx)(i.A,{className:"sm"===t?"h-4":"h-5"})})},c=e=>{let{className:t,onClick:a,value:r=1,size:i="sm"}=e;return(0,s.jsxs)("div",{className:(0,l.cn)("inline-flex items-center justify-between gap-3",t),children:[(0,s.jsx)(d,{onClick:()=>null==a?void 0:a("minus"),disabled:1===r,size:i,type:"minus"}),(0,s.jsx)("b",{className:"sm"===i?"text-sm":"text-md",children:r}),(0,s.jsx)(d,{onClick:()=>null==a?void 0:a("plus"),size:i,type:"plus"})]})}},66325:(e,t,a)=>{"use strict";a.d(t,{x:()=>n});var s=a(65453),r=a(42390);let i=e=>({items:e.items.map(e=>{var t;return{id:e.id,quantity:e.quantity,name:e.productItem.Product.name,imageUrl:e.productItem.Product.imageUrl,price:e.productItem.Price,pizzaSize:(null==(t=e.productItem.Size)?void 0:t.Size_name)||null,disabled:!1}}),totalAmount:e.totalAmount}),n=(0,s.v)((e,t)=>({items:[],error:!1,loading:!0,totalAmount:0,fetchCartItems:async()=>{try{e({loading:!0,error:!1});let t=await r.j.cart.getCart();e(i(t))}catch(t){console.error(t),e({error:!0})}finally{e({loading:!1})}},updateItemQuantity:async(a,s)=>{try{e({loading:!0,error:!1});let n=await r.j.cart.updateItemQuantity(a,s);if(!n)return void await t().fetchCartItems();e(i(n))}catch(a){console.error("Update quantity error:",a),e({error:!0}),setTimeout(()=>t().fetchCartItems(),1e3)}finally{e({loading:!1})}},removeCartItem:async t=>{try{e(e=>({loading:!0,error:!1,items:e.items.map(e=>e.id===t?{...e,disabled:!0}:e)}));let a=await r.j.cart.removeCartItem(t);e(i(a))}catch(t){console.error(t),e({error:!0})}finally{e(e=>({loading:!1,items:e.items.map(e=>({...e,disabled:!1}))}))}},addCartItem:async t=>{try{e({loading:!0,error:!1});let a=await r.j.cart.addCartItem(t);e(i(a))}catch(t){console.error(t),e({error:!0})}finally{e({loading:!1})}}}))},68838:(e,t,a)=>{"use strict";a.d(t,{Qr:()=>d,_V:()=>n,R2:()=>i,gm:()=>l});var s=a(95155),r=a(46457);let i=e=>{let{name:t,details:a,className:i}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:(0,r.cn)("flex items-center justify-between",i),children:(0,s.jsx)("h2",{className:"text-lg font-bold flex-1 leading-6",children:t})}),a&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 w-[90%]",children:[a," см"]})]})},n=e=>{let{src:t,className:a}=e;return(0,s.jsx)("img",{className:(0,r.cn)("w-[60px] h-[60px]",a),src:t})},l=e=>{let{value:t,className:a}=e;return(0,s.jsxs)("h2",{className:(0,r.cn)("font-bold",a),children:[t," ₽"]})},d=a(65219).Q},78729:(e,t,a)=>{Promise.resolve().then(a.bind(a,431)),Promise.resolve().then(a.bind(a,81985)),Promise.resolve().then(a.bind(a,40994))},81985:(e,t,a)=>{"use strict";a.d(t,{Categories:()=>n});var s=a(95155),r=a(46457),i=a(574);a(12115);let n=e=>{let{items:t,className:a}=e,n=(0,i.n)(e=>e.activeId);return(0,s.jsx)("div",{className:(0,r.cn)("inline-flex gap-1 bg-mint-500 p-1 rounded-2xl",a),children:t.map((e,t)=>{let{Name_categry:a,ID_Category:i}=e;return(0,s.jsx)("a",{className:(0,r.cn)("flex items-center font-bold h-11 rounded-2xl px-5",n===i&&"bg-main shadow-md"),href:"/#".concat(a),children:(0,s.jsx)("p",{children:a})},t)})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9352,5604,6874,3352,6814,8441,1684,7358],()=>t(78729)),_N_E=e.O()}]);