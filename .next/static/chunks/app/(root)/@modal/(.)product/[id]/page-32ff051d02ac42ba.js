(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3361],{18878:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>c,L3:()=>u,lG:()=>d});var r=a(95155);a(12115);var s=a(39527),n=a(54416),i=a(46457);function d(e){let{...t}=e;return(0,r.jsx)(s.bL,{"data-slot":"dialog",...t})}function o(e){let{...t}=e;return(0,r.jsx)(s.ZL,{"data-slot":"dialog-portal",...t})}function l(e){let{className:t,...a}=e;return(0,r.jsx)(s.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function c(e){let{className:t,children:a,...d}=e;return(0,r.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,r.jsx)(l,{}),(0,r.jsxs)(s.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-0 shadow-lg duration-200 md:max-w-4xl md:min-h-4xl ",t),...d,children:[a,(0,r.jsxs)(s.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function u(e){let{className:t,...a}=e;return(0,r.jsx)(s.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...a})}},19946:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var r=a(12115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),i=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},d=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:u,iconNode:m,...p}=e;return(0,r.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:a,strokeWidth:i?24*Number(n)/Number(s):n,className:d("lucide",c),...!u&&!o(p)&&{"aria-hidden":"true"},...p},[...m.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:o,...l}=a;return(0,r.createElement)(c,{ref:n,iconNode:t,className:d("lucide-".concat(s(i(e))),"lucide-".concat(e),o),...l})});return a.displayName=i(e),a}},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"redirect")&&a.d(t,{redirect:function(){return r.redirect}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},42390:(e,t,a)=>{"use strict";a.d(t,{j:()=>C});var r={};a.r(r),a.d(r,{addCartItem:()=>p,getCart:()=>c,removeCartItem:()=>m,updateItemQuantity:()=>u});var s={};a.r(s),a.d(s,{getMe:()=>x});var n={};a.r(n),a.d(n,{search:()=>h});var i={};a.r(i),a.d(i,{addProduct:()=>N,deleteProduct:()=>j,getCategories:()=>f,getOrders:()=>y,getProducts:()=>b,getSizes:()=>v,updateOrderStatus:()=>w});var d=a(23464),o=a(87358);let l=d.A.create({baseURL:o.env.NEXT_PUBLIC_API_URL}),c=async()=>(await l.get("/api/carts")).data,u=async(e,t)=>(await l.patch("/api/carts/"+e,{quantity:t})).data,m=async e=>(await l.delete("/api/carts/"+e)).data,p=async e=>(await l.post("/api/carts",e)).data,x=async()=>{let{data:e}=await l.get("api/auth/me");return e};var g=function(e){return e.SEARCH_PRODUCTS="api/products/search",e}({});let h=async e=>(await l.get(g.SEARCH_PRODUCTS,{params:{query:e}})).data,f=async()=>(await l.get("/api/categories")).data,v=async()=>(await l.get("/api/sizes")).data,b=async()=>(await l.get("/api/products")).data,y=async()=>(await l.get("/api/orders")).data,w=async(e,t)=>(await l.patch("/api/admin/orders/".concat(e,"/status"),t)).data,j=async e=>{await l.delete("/api/products/".concat(e))},N=async e=>(await l.post("/api/products",e)).data,C={cart:r,auth:s,products:n,admin:i}},46457:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(52596),s=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},50148:(e,t,a)=>{Promise.resolve().then(a.bind(a,72763))},54416:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},59877:(e,t,a)=>{"use strict";a.d(t,{y:()=>n});var r=a(52596),s=a(12115);let n=e=>{let{text:t,size:a="sm",className:n}=e;return s.createElement({xs:"h5",sm:"h4",md:"h3",lg:"h2",xl:"h1","2xl":"h1"}[a],{className:(0,r.A)({xs:"text-[16px]",sm:"text-[22px]",md:"text-[26px]",lg:"text-[32px]",xl:"text-[40px]","2xl":"text-[48px]"}[a],n)},t)}},60714:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var r=a(95155),s=a(12115),n=a(99708),i=a(74466),d=a(46457);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-dop-bg text-black shadow-xs hover:bg-dop-bg/90 rounded-2xl",red:"bg-mint-500 shadow-xs hover:bg-mint-500/90 rounded-3xl",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:l=!1,loading:c,children:u,...m}=e,p=l?n.DX:"button";return(0,r.jsx)(p,{"data-slot":"button",className:(0,d.cn)(o({variant:s,size:i,className:a}),c&&"opacity-75 pointer-events-none"),disabled:!!c,"aria-busy":!!c,ref:t,...m,children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),u]}):u})});l.displayName="Button"},66325:(e,t,a)=>{"use strict";a.d(t,{x:()=>i});var r=a(65453),s=a(42390);let n=e=>({items:e.items.map(e=>{var t;return{id:e.id,quantity:e.quantity,name:e.productItem.Product.name,imageUrl:e.productItem.Product.imageUrl,price:e.productItem.Price,pizzaSize:(null==(t=e.productItem.Size)?void 0:t.Size_name)||null,disabled:!1}}),totalAmount:e.totalAmount}),i=(0,r.v)((e,t)=>({items:[],error:!1,loading:!0,totalAmount:0,fetchCartItems:async()=>{try{e({loading:!0,error:!1});let t=await s.j.cart.getCart();e(n(t))}catch(t){console.error(t),e({error:!0})}finally{e({loading:!1})}},updateItemQuantity:async(a,r)=>{try{e({loading:!0,error:!1});let i=await s.j.cart.updateItemQuantity(a,r);if(!i)return void await t().fetchCartItems();e(n(i))}catch(a){console.error("Update quantity error:",a),e({error:!0}),setTimeout(()=>t().fetchCartItems(),1e3)}finally{e({loading:!1})}},removeCartItem:async t=>{try{e(e=>({loading:!0,error:!1,items:e.items.map(e=>e.id===t?{...e,disabled:!0}:e)}));let a=await s.j.cart.removeCartItem(t);e(n(a))}catch(t){console.error(t),e({error:!0})}finally{e(e=>({loading:!1,items:e.items.map(e=>({...e,disabled:!1}))}))}},addCartItem:async t=>{try{e({loading:!0,error:!1});let a=await s.j.cart.addCartItem(t);e(n(a))}catch(t){console.error(t),e({error:!0})}finally{e({loading:!1})}}}))},68300:(e,t,a)=>{"use strict";a.d(t,{ProductForm:()=>p});var r=a(95155),s=a(12115),n=a(13568),i=a(46457),d=a(60714);let o=e=>{let{imageUrl:t,size:a,className:s}=e;return(0,r.jsxs)("div",{className:(0,i.cn)("flex items-center justify-center flex-1 relative w-full",s),children:[(0,r.jsx)("img",{src:t,alt:"Logo",className:(0,i.cn)("relative left-2 top-2 transition-all z-10 duration-300",{"w-[250px] h-[250px]":(null==a?void 0:a.Size_name)==="25","w-[300px] h-[300px]":(null==a?void 0:a.Size_name)==="30","w-[350px] h-[350px]":(null==a?void 0:a.Size_name)==="35"})}),(0,r.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 border-dashed border-2 rounded-full border-gray-300 w-[320px] h-[320px]"}),(0,r.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 border-dotted border-2 rounded-full border-gray-200 w-[270px] h-[270px]"})]})};var l=a(59877);let c=e=>{var t;let{name:a,items:n,desc:c,imageUrl:u,className:m,loading:p,onSubmit:x}=e,[g,h]=s.useState(null==(t=n[0])?void 0:t.Id),f=n.find(e=>e.Id===g)||n[0],v=async()=>{f&&x(f.Id)};return(0,r.jsxs)("div",{className:(0,i.cn)(m,"flex flex-col md:flex-row bg-dop-bg min-h-[500px] max-h-[700px]"),children:[(0,r.jsx)("div",{className:"md:w-2/4 bg-dop-bg flex items-center justify-center p-4",children:(0,r.jsx)(o,{imageUrl:u,size:f.Size,className:"w-full h-full max-h-[400px] md:max-h-none"})}),(0,r.jsxs)("div",{className:"md:w-2/4 bg-main p-6 flex flex-col h-full overflow-y-auto",children:[(0,r.jsx)(l.y,{text:a,size:"lg",className:"font-extrabold mb-3 "}),(0,r.jsx)("p",{className:"text-dop-bg mb-6 text-lg",children:c}),(0,r.jsx)("div",{className:(0,i.cn)(m,"flex justify-between bg-mint-500 rounded-3xl p-1 select-none"),children:n.map(e=>{var t;return(0,r.jsxs)("button",{onClick:()=>null==h?void 0:h(e.Id),className:(0,i.cn)("flex items-center justify-center cursor-pointer h-[30px] px-5 flex-1 rounded-3xl transition-all duration-400 text-sm",g===e.Id?"bg-main border-dop-bg":"bg-mint-500 border-dop-bg"),children:[null==(t=e.Size)?void 0:t.Size_name," см"]},e.Id)})}),(0,r.jsx)("div",{className:"mt-auto pt-4",children:(0,r.jsxs)(d.$,{className:"w-full h-14 text-md rounded-lg",size:"lg",onClick:v,children:["Добавить в корзину за ",f.Price," ₽"]})})]})]})},u=e=>{let{name:t,desc:a,imageUrl:s,price:n,onSubmit:o,className:c,loading:u}=e;return(0,r.jsxs)("div",{className:(0,i.cn)(c,"flex flex-1"),children:[(0,r.jsx)("div",{className:"flex items-center justify-center bg-dop-bg flex-1 relative 'min-h-[500px] max-h-[700px]'",children:(0,r.jsx)("img",{src:s,alt:t,className:"relative left-2 top-2 transition-all z-10 duration-300 w-[350px] h-[350px]"})}),(0,r.jsxs)("div",{className:"w-[490px] bg-main p-7",children:[(0,r.jsx)(l.y,{text:t,size:"md",className:"font-extrabold mb-1"}),(0,r.jsx)("p",{className:"text-dop-bg mb-6 text-mb",children:a}),(0,r.jsxs)(d.$,{onClick:()=>null==o?void 0:o(),disabled:u,className:"h-[55px] px-10 text-base rounded-[18px] w-full mt-10",children:["Добавить в корзину за ",n," ₽"]})]})]})};var m=a(66325);let p=e=>{let{product:t,onSubmit:a}=e,i=(0,m.x)(e=>e.addCartItem),d=(0,m.x)(e=>e.loading),o=t.ProductItems[0],l=!!(null==o?void 0:o.Size),p=(0,s.useCallback)(async(e,r)=>{try{let r=null!=e?e:o.Id;await i({productItemId:r}),n.Ay.success("".concat(t.name," добавлен(а) в корзину")),null==a||a()}catch(e){n.Ay.error("Не удалось добавить товар в корзину"),console.error(e)}},[i,null==o?void 0:o.Id,t.name,a]);return l?(0,r.jsx)(c,{imageUrl:t.imageUrl||"",name:t.name,desc:t.description||"",items:t.ProductItems,onSubmit:p}):(0,r.jsx)(u,{imageUrl:t.imageUrl||"",name:t.name,desc:t.description||"",onSubmit:p,price:o.Price,loading:d})}},72763:(e,t,a)=>{"use strict";a.d(t,{ChooseProductModal:()=>o});var r=a(95155);a(12115);var s=a(35695),n=a(18878),i=a(46457),d=a(68300);let o=e=>{let{product:t,className:a}=e,o=(0,s.useRouter)();return(0,r.jsx)(n.lG,{open:!!t,onOpenChange:()=>o.back(),children:(0,r.jsxs)(n.Cf,{className:(0,i.cn)("p-0 w-full","sm:rounded-2xl overflow-hidden",a),children:[(0,r.jsx)(n.L3,{hidden:!0}),(0,r.jsx)(d.ProductForm,{product:t,onSubmit:()=>o.back()})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9352,3568,5604,9527,8441,1684,7358],()=>t(50148)),_N_E=e.O()}]);